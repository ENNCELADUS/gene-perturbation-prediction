2025-12-03 00:04:47,091 - ZeroShotPerturbation - INFO - Starting Perturbation Pipeline with scgpt model
2025-12-03 00:04:47,091 - ZeroShotPerturbation - INFO - Model directory: model/scGPT
2025-12-03 00:04:47,091 - ZeroShotPerturbation - INFO - Results will be saved to: results/scgpt_zeroshot
2025-12-03 00:04:47,091 - ZeroShotPerturbation - INFO - Initializing scGPT Model Wrapper...
2025-12-03 00:04:48,151 - ZeroShotPerturbation - INFO - Model vocab size: 60697, Saved checkpoint vocab size: 60697
2025-12-03 00:04:48,193 - ZeroShotPerturbation - INFO - Loaded model from model/scGPT/best_model.pt
2025-12-03 00:04:48,264 - ZeroShotPerturbation - INFO - Initializing Data Loader...
2025-12-03 00:04:48,264 - ZeroShotPerturbation - INFO - Loading training data from data/processed/train.h5ad
2025-12-03 00:05:05,303 - ZeroShotPerturbation - INFO - Loading test data from data/processed/test.h5ad
2025-12-03 00:05:08,052 - ZeroShotPerturbation - INFO - Found 38176 control cells.
2025-12-03 00:05:15,182 - ZeroShotPerturbation - INFO - Processing 30 target genes...
2025-12-03 00:05:15,183 - ZeroShotPerturbation - INFO - Predicting for target: AKT2
2025-12-03 00:05:15,186 - ZeroShotPerturbation - INFO - Processing 938 cells in batches of 16
2025-12-03 00:05:34,772 - ZeroShotPerturbation - INFO - Target AKT2 - DES: 0.0451, MAE_top2k: 1.3610, n_DE: 421
2025-12-03 00:05:34,773 - ZeroShotPerturbation - INFO - Predicting for target: MAP3K7
2025-12-03 00:05:34,776 - ZeroShotPerturbation - INFO - Processing 2019 cells in batches of 16
2025-12-03 00:06:20,229 - ZeroShotPerturbation - INFO - Target MAP3K7 - DES: 0.0116, MAE_top2k: 1.2443, n_DE: 86
2025-12-03 00:06:20,230 - ZeroShotPerturbation - INFO - Predicting for target: ZNF426
2025-12-03 00:06:20,233 - ZeroShotPerturbation - INFO - Processing 1132 cells in batches of 16
2025-12-03 00:06:43,721 - ZeroShotPerturbation - INFO - Target ZNF426 - DES: 0.0000, MAE_top2k: 1.1999, n_DE: 15
2025-12-03 00:06:43,721 - ZeroShotPerturbation - INFO - Predicting for target: DNMT1
2025-12-03 00:06:43,723 - ZeroShotPerturbation - INFO - Processing 893 cells in batches of 16
2025-12-03 00:07:02,005 - ZeroShotPerturbation - INFO - Target DNMT1 - DES: 0.5330, MAE_top2k: 1.3004, n_DE: 8144
2025-12-03 00:07:02,005 - ZeroShotPerturbation - INFO - Predicting for target: SRC
2025-12-03 00:07:02,008 - ZeroShotPerturbation - INFO - Processing 2403 cells in batches of 16
2025-12-03 00:07:56,402 - ZeroShotPerturbation - INFO - Target SRC - DES: 0.0188, MAE_top2k: 1.2996, n_DE: 213
2025-12-03 00:07:56,404 - ZeroShotPerturbation - INFO - Predicting for target: MED13
2025-12-03 00:07:56,407 - ZeroShotPerturbation - INFO - Processing 2787 cells in batches of 16
2025-12-03 00:08:59,725 - ZeroShotPerturbation - INFO - Target MED13 - DES: 0.3364, MAE_top2k: 1.4096, n_DE: 4729
2025-12-03 00:08:59,729 - ZeroShotPerturbation - INFO - Predicting for target: KDR
2025-12-03 00:08:59,732 - ZeroShotPerturbation - INFO - Processing 2056 cells in batches of 16
2025-12-03 00:09:45,761 - ZeroShotPerturbation - INFO - Target KDR - DES: 0.0000, MAE_top2k: 1.3086, n_DE: 19
2025-12-03 00:09:45,762 - ZeroShotPerturbation - INFO - Predicting for target: EIF4B
2025-12-03 00:09:45,764 - ZeroShotPerturbation - INFO - Processing 1585 cells in batches of 16
2025-12-03 00:10:20,440 - ZeroShotPerturbation - INFO - Target EIF4B - DES: 0.3286, MAE_top2k: 1.5339, n_DE: 4333
2025-12-03 00:10:20,440 - ZeroShotPerturbation - INFO - Predicting for target: SIX4
2025-12-03 00:10:20,443 - ZeroShotPerturbation - INFO - Processing 642 cells in batches of 16
2025-12-03 00:10:34,034 - ZeroShotPerturbation - INFO - Target SIX4 - DES: 0.0190, MAE_top2k: 1.2743, n_DE: 105
2025-12-03 00:10:34,035 - ZeroShotPerturbation - INFO - Predicting for target: TFAM
2025-12-03 00:10:34,038 - ZeroShotPerturbation - INFO - Processing 1105 cells in batches of 16
2025-12-03 00:10:56,790 - ZeroShotPerturbation - INFO - Target TFAM - DES: 0.2787, MAE_top2k: 1.6539, n_DE: 3236
2025-12-03 00:10:56,791 - ZeroShotPerturbation - INFO - Predicting for target: MAST2
2025-12-03 00:10:56,794 - ZeroShotPerturbation - INFO - Processing 1029 cells in batches of 16
2025-12-03 00:11:17,785 - ZeroShotPerturbation - INFO - Target MAST2 - DES: 0.0000, MAE_top2k: 1.3239, n_DE: 27
2025-12-03 00:11:17,785 - ZeroShotPerturbation - INFO - Predicting for target: SMAGP
2025-12-03 00:11:17,787 - ZeroShotPerturbation - INFO - Processing 788 cells in batches of 16
2025-12-03 00:11:34,474 - ZeroShotPerturbation - INFO - Target SMAGP - DES: 0.1231, MAE_top2k: 1.4236, n_DE: 796
2025-12-03 00:11:34,475 - ZeroShotPerturbation - INFO - Predicting for target: XRCC4
2025-12-03 00:11:34,478 - ZeroShotPerturbation - INFO - Processing 591 cells in batches of 16
2025-12-03 00:11:46,691 - ZeroShotPerturbation - INFO - Target XRCC4 - DES: 0.2740, MAE_top2k: 1.7536, n_DE: 2518
2025-12-03 00:11:46,691 - ZeroShotPerturbation - INFO - Predicting for target: HMGN1
2025-12-03 00:11:46,694 - ZeroShotPerturbation - INFO - Processing 2004 cells in batches of 16
2025-12-03 00:12:31,468 - ZeroShotPerturbation - INFO - Target HMGN1 - DES: 0.0000, MAE_top2k: 1.3348, n_DE: 15
2025-12-03 00:12:31,470 - ZeroShotPerturbation - INFO - Predicting for target: GSK3B
2025-12-03 00:12:31,472 - ZeroShotPerturbation - INFO - Processing 1059 cells in batches of 16
2025-12-03 00:12:53,624 - ZeroShotPerturbation - INFO - Target GSK3B - DES: 0.1821, MAE_top2k: 1.3784, n_DE: 2169
2025-12-03 00:12:53,625 - ZeroShotPerturbation - INFO - Predicting for target: TMBIM6
2025-12-03 00:12:53,627 - ZeroShotPerturbation - INFO - Processing 505 cells in batches of 16
2025-12-03 00:13:04,156 - ZeroShotPerturbation - INFO - Target TMBIM6 - DES: 0.0000, MAE_top2k: 1.5704, n_DE: 10
2025-12-03 00:13:04,156 - ZeroShotPerturbation - INFO - Predicting for target: PMEL
2025-12-03 00:13:04,158 - ZeroShotPerturbation - INFO - Processing 356 cells in batches of 16
2025-12-03 00:13:11,619 - ZeroShotPerturbation - INFO - Target PMEL - DES: 0.0154, MAE_top2k: 1.3394, n_DE: 65
2025-12-03 00:13:11,619 - ZeroShotPerturbation - INFO - Predicting for target: DAXX
2025-12-03 00:13:11,621 - ZeroShotPerturbation - INFO - Processing 1332 cells in batches of 16
2025-12-03 00:13:40,166 - ZeroShotPerturbation - INFO - Target DAXX - DES: 0.0589, MAE_top2k: 1.3993, n_DE: 696
2025-12-03 00:13:40,167 - ZeroShotPerturbation - INFO - Predicting for target: METTL14
2025-12-03 00:13:40,169 - ZeroShotPerturbation - INFO - Processing 468 cells in batches of 16
2025-12-03 00:13:49,835 - ZeroShotPerturbation - INFO - Target METTL14 - DES: 0.6729, MAE_top2k: 1.5221, n_DE: 9564
2025-12-03 00:13:49,836 - ZeroShotPerturbation - INFO - Predicting for target: MAU2
2025-12-03 00:13:49,838 - ZeroShotPerturbation - INFO - Processing 1021 cells in batches of 16
2025-12-03 00:14:10,949 - ZeroShotPerturbation - INFO - Target MAU2 - DES: 0.4927, MAE_top2k: 1.4633, n_DE: 7138
2025-12-03 00:14:10,950 - ZeroShotPerturbation - INFO - Predicting for target: NDUFB4
2025-12-03 00:14:10,952 - ZeroShotPerturbation - INFO - Processing 1413 cells in batches of 16
2025-12-03 00:14:40,935 - ZeroShotPerturbation - INFO - Target NDUFB4 - DES: 0.2010, MAE_top2k: 1.7061, n_DE: 1358
2025-12-03 00:14:40,936 - ZeroShotPerturbation - INFO - Predicting for target: KDM1A
2025-12-03 00:14:40,938 - ZeroShotPerturbation - INFO - Processing 352 cells in batches of 16
2025-12-03 00:14:47,993 - ZeroShotPerturbation - INFO - Target KDM1A - DES: 0.7104, MAE_top2k: 1.6067, n_DE: 10128
2025-12-03 00:14:47,993 - ZeroShotPerturbation - INFO - Predicting for target: TXNDC9
2025-12-03 00:14:47,995 - ZeroShotPerturbation - INFO - Processing 514 cells in batches of 16
2025-12-03 00:14:58,983 - ZeroShotPerturbation - INFO - Target TXNDC9 - DES: 0.0388, MAE_top2k: 1.7049, n_DE: 309
2025-12-03 00:14:58,984 - ZeroShotPerturbation - INFO - Predicting for target: CALM3
2025-12-03 00:14:58,986 - ZeroShotPerturbation - INFO - Processing 681 cells in batches of 16
2025-12-03 00:15:13,177 - ZeroShotPerturbation - INFO - Target CALM3 - DES: 0.0250, MAE_top2k: 1.8863, n_DE: 160
2025-12-03 00:15:13,177 - ZeroShotPerturbation - INFO - Predicting for target: C1QBP
2025-12-03 00:15:13,180 - ZeroShotPerturbation - INFO - Processing 711 cells in batches of 16
2025-12-03 00:15:27,720 - ZeroShotPerturbation - INFO - Target C1QBP - DES: 0.2724, MAE_top2k: 1.7222, n_DE: 2772
2025-12-03 00:15:27,720 - ZeroShotPerturbation - INFO - Predicting for target: MBTPS1
2025-12-03 00:15:27,723 - ZeroShotPerturbation - INFO - Processing 626 cells in batches of 16
2025-12-03 00:15:40,475 - ZeroShotPerturbation - INFO - Target MBTPS1 - DES: 0.2941, MAE_top2k: 1.5762, n_DE: 3608
2025-12-03 00:15:40,475 - ZeroShotPerturbation - INFO - Predicting for target: ZNF562
2025-12-03 00:15:40,478 - ZeroShotPerturbation - INFO - Processing 418 cells in batches of 16
2025-12-03 00:15:48,892 - ZeroShotPerturbation - INFO - Target ZNF562 - DES: 0.0000, MAE_top2k: 1.1874, n_DE: 21
2025-12-03 00:15:48,893 - ZeroShotPerturbation - INFO - Predicting for target: PHF10
2025-12-03 00:15:48,895 - ZeroShotPerturbation - INFO - Processing 450 cells in batches of 16
2025-12-03 00:15:57,923 - ZeroShotPerturbation - INFO - Target PHF10 - DES: 0.1478, MAE_top2k: 1.4731, n_DE: 1245
2025-12-03 00:15:57,923 - ZeroShotPerturbation - INFO - Predicting for target: FDPS
2025-12-03 00:15:57,926 - ZeroShotPerturbation - INFO - Processing 154 cells in batches of 16
2025-12-03 00:16:00,950 - ZeroShotPerturbation - INFO - Target FDPS - DES: 0.1541, MAE_top2k: 1.6282, n_DE: 1506
2025-12-03 00:16:00,951 - ZeroShotPerturbation - INFO - Predicting for target: OXA1L
2025-12-03 00:16:00,953 - ZeroShotPerturbation - INFO - Processing 63 cells in batches of 16
2025-12-03 00:16:02,196 - ZeroShotPerturbation - INFO - Target OXA1L - DES: 0.0661, MAE_top2k: 1.5763, n_DE: 454
2025-12-03 00:16:02,243 - ZeroShotPerturbation - INFO - Results saved to results/scgpt_zeroshot/perturbation_metrics.csv
2025-12-03 00:16:02,243 - ZeroShotPerturbation - INFO - ==================================================
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO - Final Test Metrics (per eval_metrics.md Section 4.2.2):
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO - --------------------------------------------------
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO - Three DE Metrics (raw, averaged):
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO -   pds:                   0.4833
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO -   mae:                   1.4721
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO -   des:                   0.1767
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO - --------------------------------------------------
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO - Overall Score (0-100, averaged from per-perturbation):
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO -   overall_score:         12.60
2025-12-03 00:16:02,244 - ZeroShotPerturbation - INFO - ==================================================
