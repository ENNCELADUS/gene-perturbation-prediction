2025-12-12 02:31:17,384 - ZeroShotPerturbation - INFO - Starting Perturbation Pipeline with scgpt model
2025-12-12 02:31:17,385 - ZeroShotPerturbation - INFO - Model directory: model/scGPT
2025-12-12 02:31:17,385 - ZeroShotPerturbation - INFO - Results will be saved to: results/scgpt_zeroshot
2025-12-12 02:31:17,385 - ZeroShotPerturbation - INFO - Initializing scGPT Model Wrapper...
2025-12-12 02:31:18,519 - ZeroShotPerturbation - INFO - Model vocab size: 60697, Saved checkpoint vocab size: 60697
2025-12-12 02:31:18,568 - ZeroShotPerturbation - INFO - Loaded model from model/scGPT/best_model.pt
2025-12-12 02:31:18,629 - ZeroShotPerturbation - INFO - Initializing Data Loader...
2025-12-12 02:31:18,629 - ZeroShotPerturbation - INFO - Loading training data from data/processed/train.h5ad
2025-12-12 02:31:35,104 - ZeroShotPerturbation - INFO - Loading test data from data/processed/test.h5ad
2025-12-12 02:31:37,887 - ZeroShotPerturbation - INFO - Found 38176 control cells.
2025-12-12 02:31:41,875 - ZeroShotPerturbation - INFO - Processing 30 target genes...
2025-12-12 02:31:41,876 - ZeroShotPerturbation - INFO - Predicting for target: AKT2
2025-12-12 02:31:41,879 - ZeroShotPerturbation - INFO - Processing 938 cells in batches of 16
2025-12-12 02:32:32,130 - ZeroShotPerturbation - INFO - Target AKT2 - DES: 0.0543, MAE_top2k: 1.3070, n_DE: 350
2025-12-12 02:32:32,131 - ZeroShotPerturbation - INFO - Predicting for target: MAP3K7
2025-12-12 02:32:32,134 - ZeroShotPerturbation - INFO - Processing 2019 cells in batches of 16
2025-12-12 02:33:45,946 - ZeroShotPerturbation - INFO - Target MAP3K7 - DES: 0.0143, MAE_top2k: 1.1917, n_DE: 70
2025-12-12 02:33:45,947 - ZeroShotPerturbation - INFO - Predicting for target: ZNF426
2025-12-12 02:33:45,950 - ZeroShotPerturbation - INFO - Processing 1132 cells in batches of 16
2025-12-12 02:34:40,944 - ZeroShotPerturbation - INFO - Target ZNF426 - DES: 0.0000, MAE_top2k: 1.1515, n_DE: 18
2025-12-12 02:34:40,946 - ZeroShotPerturbation - INFO - Predicting for target: DNMT1
2025-12-12 02:34:40,949 - ZeroShotPerturbation - INFO - Processing 893 cells in batches of 16
2025-12-12 02:35:32,115 - ZeroShotPerturbation - INFO - Target DNMT1 - DES: 0.6028, MAE_top2k: 1.2492, n_DE: 8192
2025-12-12 02:35:32,115 - ZeroShotPerturbation - INFO - Predicting for target: SRC
2025-12-12 02:35:32,119 - ZeroShotPerturbation - INFO - Processing 2403 cells in batches of 16
2025-12-12 02:36:54,332 - ZeroShotPerturbation - INFO - Target SRC - DES: 0.0556, MAE_top2k: 1.2418, n_DE: 180
2025-12-12 02:36:54,333 - ZeroShotPerturbation - INFO - Predicting for target: MED13
2025-12-12 02:36:54,337 - ZeroShotPerturbation - INFO - Processing 2787 cells in batches of 16
2025-12-12 02:38:25,630 - ZeroShotPerturbation - INFO - Target MED13 - DES: 0.4274, MAE_top2k: 1.3563, n_DE: 4694
2025-12-12 02:38:25,631 - ZeroShotPerturbation - INFO - Predicting for target: KDR
2025-12-12 02:38:25,635 - ZeroShotPerturbation - INFO - Processing 2056 cells in batches of 16
2025-12-12 02:39:40,241 - ZeroShotPerturbation - INFO - Target KDR - DES: 0.0000, MAE_top2k: 1.2589, n_DE: 19
2025-12-12 02:39:40,242 - ZeroShotPerturbation - INFO - Predicting for target: EIF4B
2025-12-12 02:39:40,247 - ZeroShotPerturbation - INFO - Processing 1585 cells in batches of 16
2025-12-12 02:40:45,081 - ZeroShotPerturbation - INFO - Target EIF4B - DES: 0.4502, MAE_top2k: 1.4790, n_DE: 4474
2025-12-12 02:40:45,082 - ZeroShotPerturbation - INFO - Predicting for target: SIX4
2025-12-12 02:40:45,085 - ZeroShotPerturbation - INFO - Processing 642 cells in batches of 16
2025-12-12 02:41:30,187 - ZeroShotPerturbation - INFO - Target SIX4 - DES: 0.0297, MAE_top2k: 1.2228, n_DE: 101
2025-12-12 02:41:30,188 - ZeroShotPerturbation - INFO - Predicting for target: TFAM
2025-12-12 02:41:30,190 - ZeroShotPerturbation - INFO - Processing 1105 cells in batches of 16
2025-12-12 02:42:24,540 - ZeroShotPerturbation - INFO - Target TFAM - DES: 0.4580, MAE_top2k: 1.5962, n_DE: 3607
2025-12-12 02:42:24,540 - ZeroShotPerturbation - INFO - Predicting for target: MAST2
2025-12-12 02:42:24,543 - ZeroShotPerturbation - INFO - Processing 1029 cells in batches of 16
2025-12-12 02:43:18,059 - ZeroShotPerturbation - INFO - Target MAST2 - DES: 0.0455, MAE_top2k: 1.2675, n_DE: 22
2025-12-12 02:43:18,060 - ZeroShotPerturbation - INFO - Predicting for target: SMAGP
2025-12-12 02:43:18,062 - ZeroShotPerturbation - INFO - Processing 788 cells in batches of 16
2025-12-12 02:44:06,558 - ZeroShotPerturbation - INFO - Target SMAGP - DES: 0.1305, MAE_top2k: 1.3697, n_DE: 858
2025-12-12 02:44:06,558 - ZeroShotPerturbation - INFO - Predicting for target: XRCC4
2025-12-12 02:44:06,561 - ZeroShotPerturbation - INFO - Processing 591 cells in batches of 16
2025-12-12 02:44:50,276 - ZeroShotPerturbation - INFO - Target XRCC4 - DES: 0.3038, MAE_top2k: 1.6970, n_DE: 1478
2025-12-12 02:44:50,277 - ZeroShotPerturbation - INFO - Predicting for target: HMGN1
2025-12-12 02:44:50,281 - ZeroShotPerturbation - INFO - Processing 2004 cells in batches of 16
2025-12-12 02:46:03,825 - ZeroShotPerturbation - INFO - Target HMGN1 - DES: 0.0000, MAE_top2k: 1.2831, n_DE: 17
2025-12-12 02:46:03,826 - ZeroShotPerturbation - INFO - Predicting for target: GSK3B
2025-12-12 02:46:03,831 - ZeroShotPerturbation - INFO - Processing 1059 cells in batches of 16
2025-12-12 02:46:57,486 - ZeroShotPerturbation - INFO - Target GSK3B - DES: 0.2217, MAE_top2k: 1.3238, n_DE: 2269
2025-12-12 02:46:57,486 - ZeroShotPerturbation - INFO - Predicting for target: TMBIM6
2025-12-12 02:46:57,490 - ZeroShotPerturbation - INFO - Processing 505 cells in batches of 16
2025-12-12 02:47:38,972 - ZeroShotPerturbation - INFO - Target TMBIM6 - DES: 0.0000, MAE_top2k: 1.5174, n_DE: 35
2025-12-12 02:47:38,972 - ZeroShotPerturbation - INFO - Predicting for target: PMEL
2025-12-12 02:47:38,976 - ZeroShotPerturbation - INFO - Processing 356 cells in batches of 16
2025-12-12 02:48:16,448 - ZeroShotPerturbation - INFO - Target PMEL - DES: 0.0455, MAE_top2k: 1.2862, n_DE: 44
2025-12-12 02:48:16,449 - ZeroShotPerturbation - INFO - Predicting for target: DAXX
2025-12-12 02:48:16,452 - ZeroShotPerturbation - INFO - Processing 1332 cells in batches of 16
2025-12-12 02:49:15,587 - ZeroShotPerturbation - INFO - Target DAXX - DES: 0.1025, MAE_top2k: 1.3433, n_DE: 644
2025-12-12 02:49:15,588 - ZeroShotPerturbation - INFO - Predicting for target: METTL14
2025-12-12 02:49:15,591 - ZeroShotPerturbation - INFO - Processing 468 cells in batches of 16
2025-12-12 02:49:56,124 - ZeroShotPerturbation - INFO - Target METTL14 - DES: 0.7894, MAE_top2k: 1.4695, n_DE: 9408
2025-12-12 02:49:56,125 - ZeroShotPerturbation - INFO - Predicting for target: MAU2
2025-12-12 02:49:56,129 - ZeroShotPerturbation - INFO - Processing 1021 cells in batches of 16
2025-12-12 02:50:48,485 - ZeroShotPerturbation - INFO - Target MAU2 - DES: 0.5821, MAE_top2k: 1.4080, n_DE: 6848
2025-12-12 02:50:48,485 - ZeroShotPerturbation - INFO - Predicting for target: NDUFB4
2025-12-12 02:50:48,489 - ZeroShotPerturbation - INFO - Processing 1413 cells in batches of 16
2025-12-12 02:51:49,514 - ZeroShotPerturbation - INFO - Target NDUFB4 - DES: 0.2285, MAE_top2k: 1.6502, n_DE: 1186
2025-12-12 02:51:49,514 - ZeroShotPerturbation - INFO - Predicting for target: KDM1A
2025-12-12 02:51:49,518 - ZeroShotPerturbation - INFO - Processing 352 cells in batches of 16
2025-12-12 02:52:26,913 - ZeroShotPerturbation - INFO - Target KDM1A - DES: 0.8191, MAE_top2k: 1.5586, n_DE: 10102
2025-12-12 02:52:26,913 - ZeroShotPerturbation - INFO - Predicting for target: TXNDC9
2025-12-12 02:52:26,917 - ZeroShotPerturbation - INFO - Processing 514 cells in batches of 16
2025-12-12 02:53:08,564 - ZeroShotPerturbation - INFO - Target TXNDC9 - DES: 0.0800, MAE_top2k: 1.6507, n_DE: 100
2025-12-12 02:53:08,564 - ZeroShotPerturbation - INFO - Predicting for target: CALM3
2025-12-12 02:53:08,566 - ZeroShotPerturbation - INFO - Processing 681 cells in batches of 16
2025-12-12 02:53:54,221 - ZeroShotPerturbation - INFO - Target CALM3 - DES: 0.0000, MAE_top2k: 1.8288, n_DE: 51
2025-12-12 02:53:54,222 - ZeroShotPerturbation - INFO - Predicting for target: C1QBP
2025-12-12 02:53:54,226 - ZeroShotPerturbation - INFO - Processing 711 cells in batches of 16
2025-12-12 02:54:40,520 - ZeroShotPerturbation - INFO - Target C1QBP - DES: 0.5368, MAE_top2k: 1.6655, n_DE: 3888
2025-12-12 02:54:40,520 - ZeroShotPerturbation - INFO - Predicting for target: MBTPS1
2025-12-12 02:54:40,524 - ZeroShotPerturbation - INFO - Processing 626 cells in batches of 16
2025-12-12 02:55:24,876 - ZeroShotPerturbation - INFO - Target MBTPS1 - DES: 0.4653, MAE_top2k: 1.5208, n_DE: 3888
2025-12-12 02:55:24,877 - ZeroShotPerturbation - INFO - Predicting for target: ZNF562
2025-12-12 02:55:24,881 - ZeroShotPerturbation - INFO - Processing 418 cells in batches of 16
2025-12-12 02:56:04,078 - ZeroShotPerturbation - INFO - Target ZNF562 - DES: 0.0000, MAE_top2k: 1.1364, n_DE: 26
2025-12-12 02:56:04,078 - ZeroShotPerturbation - INFO - Predicting for target: PHF10
2025-12-12 02:56:04,080 - ZeroShotPerturbation - INFO - Processing 450 cells in batches of 16
2025-12-12 02:56:43,892 - ZeroShotPerturbation - INFO - Target PHF10 - DES: 0.1040, MAE_top2k: 1.4183, n_DE: 644
2025-12-12 02:56:43,893 - ZeroShotPerturbation - INFO - Predicting for target: FDPS
2025-12-12 02:56:43,896 - ZeroShotPerturbation - INFO - Processing 154 cells in batches of 16
2025-12-12 02:57:15,288 - ZeroShotPerturbation - INFO - Target FDPS - DES: 0.3064, MAE_top2k: 1.5738, n_DE: 1805
2025-12-12 02:57:15,289 - ZeroShotPerturbation - INFO - Predicting for target: OXA1L
2025-12-12 02:57:15,291 - ZeroShotPerturbation - INFO - Processing 63 cells in batches of 16
2025-12-12 02:57:42,917 - ZeroShotPerturbation - INFO - Target OXA1L - DES: 0.2679, MAE_top2k: 1.5252, n_DE: 896
2025-12-12 02:57:42,963 - ZeroShotPerturbation - INFO - Results saved to results/scgpt_zeroshot/perturbation_metrics.csv
2025-12-12 02:57:42,963 - ZeroShotPerturbation - INFO - ==================================================
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO - Final Test Metrics (per eval_metrics.md Section 4.2.2):
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO - --------------------------------------------------
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO - Three DE Metrics (raw, averaged):
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO -   pds:                   0.4833
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO -   mae:                   1.4183
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO -   des:                   0.2374
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO - --------------------------------------------------
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO - Overall Score (0-100, from meaned metrics):
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO -   overall_score:         0.00
2025-12-12 02:57:42,964 - ZeroShotPerturbation - INFO - ==================================================
