{
  "config": {
    "data": {
      "h5ad_path": "data/norman/perturb_processed.h5ad"
    },
    "split": {
      "min_cells_per_condition": 50,
      "query_fraction": 0.2,
      "min_query_cells": 10,
      "seed": 42,
      "output_path": "data/norman/splits/cell_split_seed42.json"
    },
    "track": "in_dist",
    "condition_split": {
      "train_ratio": 0.7,
      "val_ratio": 0.1,
      "test_ratio": 0.2,
      "seed": 42,
      "output_path": "data/norman/splits/condition_split_in_dist_seed42.json",
      "n_holdout_genes": 5
    },
    "model": {
      "encoder": "pca",
      "n_components": 50
    },
    "library": {
      "type": "bootstrap",
      "n_prototypes": 30,
      "m_cells_per_prototype": 50,
      "seed": 42
    },
    "retrieval": {
      "metric": "cosine",
      "top_k": [
        1,
        5,
        8,
        10
      ]
    },
    "query": {
      "mode": "cell",
      "query_split": "test",
      "candidate_source": "all",
      "pseudo_bulk": {
        "cells_per_bulk": 50,
        "n_bulks": 1,
        "seed": 42
      },
      "pseudo_bulk_curve": {
        "enable": false,
        "cells_per_bulk_values": [
          10,
          25,
          50,
          100,
          200
        ],
        "n_bulks": 5,
        "seed": 42
      }
    },
    "evaluate": {
      "mask_perturbed": true,
      "mask_ablation": true
    },
    "confidence": {
      "enable": true,
      "method": "margin",
      "coverage_points": 20,
      "top_k_agreement": 1
    },
    "report": {
      "enable": false,
      "result_dirs": [],
      "output_dir": "results/reports",
      "report_name": "comparison_report"
    },
    "logging": {
      "output_dir": "results/",
      "experiment_name": "pca"
    }
  },
  "summary": {
    "h5ad_path": "data/norman/perturb_processed.h5ad",
    "loaded": true,
    "has_split": true,
    "n_cells": 91205,
    "n_genes": 5045,
    "n_control_cells": 7353,
    "n_perturbed_cells": 83852,
    "n_conditions": 282,
    "n_ref_cells": 67152,
    "n_query_cells": 16651,
    "n_valid_conditions": 282,
    "n_dropped_conditions": 1,
    "split_seed": 42
  },
  "metrics": {
    "exact_hit@1": 0.18719596420635398,
    "exact_hit@5": 0.42477929253498287,
    "exact_hit@8": 0.5048946009248694,
    "exact_hit@10": 0.5420695453726503,
    "mrr": 0.2891257782315377,
    "relevant_hit@1": 0.40994534862771004,
    "relevant_hit@5": 0.6175605068764639,
    "relevant_hit@8": 0.6736532340399976,
    "relevant_hit@10": 0.7015794847156327,
    "ndcg@1": 0.18719596420635398,
    "ndcg@5": 0.311047680239485,
    "ndcg@8": 0.33803958861699807,
    "ndcg@10": 0.3490205349785947,
    "macro_hit@1": 0.18298310209233087,
    "macro_hit@5": 0.4119256226068732,
    "n_queries": 16651,
    "n_in_pool": 16651,
    "n_conditions": 282,
    "confidence_auc": 0.26146810597759107,
    "coverage_accuracy_curve": {
      "coverage": [
        0.05,
        0.1,
        0.15,
        0.2,
        0.25,
        0.3,
        0.35,
        0.39999999999999997,
        0.44999999999999996,
        0.49999999999999994,
        0.5499999999999999,
        0.6,
        0.65,
        0.7,
        0.75,
        0.7999999999999999,
        0.85,
        0.9,
        0.95,
        1.0
      ],
      "accuracy": [
        0.6201923076923077,
        0.48768768768768767,
        0.408089707649179,
        0.35735735735735735,
        0.3250840941854877,
        0.3009009009009009,
        0.2831645786854299,
        0.26756756756756755,
        0.25547250400427124,
        0.24420420420420422,
        0.23520419305525223,
        0.22772772772772773,
        0.22027164372170377,
        0.21492921492921493,
        0.20924087123638693,
        0.20352852852852854,
        0.19910972938599591,
        0.19539539539539538,
        0.19073207738019976,
        0.18719596420635398
      ]
    }
  },
  "metrics_mask_off": {
    "exact_hit@1": 0.1871359077532881,
    "exact_hit@5": 0.4320461233559546,
    "exact_hit@8": 0.5108401897783917,
    "exact_hit@10": 0.5456128761035374,
    "mrr": 0.2914816594265276,
    "relevant_hit@1": 0.4183532520569335,
    "relevant_hit@5": 0.6215242327788121,
    "relevant_hit@8": 0.6788180890036635,
    "relevant_hit@10": 0.7058434928833103,
    "ndcg@1": 0.1871359077532881,
    "ndcg@5": 0.3149218836774629,
    "ndcg@8": 0.34150728786583423,
    "ndcg@10": 0.3517945444860718,
    "macro_hit@1": 0.18254435197512198,
    "macro_hit@5": 0.42038755133057365,
    "n_queries": 16651,
    "n_in_pool": 16651,
    "n_conditions": 282,
    "confidence_auc": 0.26869638710093674,
    "coverage_accuracy_curve": {
      "coverage": [
        0.05,
        0.1,
        0.15,
        0.2,
        0.25,
        0.3,
        0.35,
        0.39999999999999997,
        0.44999999999999996,
        0.49999999999999994,
        0.5499999999999999,
        0.6,
        0.65,
        0.7,
        0.75,
        0.7999999999999999,
        0.85,
        0.9,
        0.95,
        1.0
      ],
      "accuracy": [
        0.6430288461538461,
        0.5021021021021022,
        0.4181017220664798,
        0.372972972972973,
        0.3402210475732821,
        0.3155155155155155,
        0.2948343916251931,
        0.2797297297297297,
        0.26308061932728244,
        0.2508108108108108,
        0.24077309456213147,
        0.23243243243243245,
        0.22479903908343343,
        0.2174174174174174,
        0.21236386931454196,
        0.2066066066066066,
        0.2008054829364799,
        0.19586252919586253,
        0.19041598179289418,
        0.1871359077532881
      ]
    }
  }
}