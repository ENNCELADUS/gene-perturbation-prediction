2025-12-02 13:42:18,777 - ZeroShotPerturbation - INFO - Starting Perturbation Pipeline with scgpt_finetuned model
2025-12-02 13:42:18,777 - ZeroShotPerturbation - INFO - Model directory: model/scGPT_finetuned
2025-12-02 13:42:18,777 - ZeroShotPerturbation - INFO - Results will be saved to: results/scgpt_finetuned
2025-12-02 13:42:18,777 - ZeroShotPerturbation - INFO - Initializing scGPT Model Wrapper...
2025-12-02 13:42:20,366 - ZeroShotPerturbation - INFO - Model vocab size: 60697, Saved checkpoint vocab size: 60697
2025-12-02 13:42:20,459 - ZeroShotPerturbation - INFO - Loaded model from model/scGPT_finetuned/best_model.pt
2025-12-02 13:42:20,535 - ZeroShotPerturbation - INFO - Initializing Data Loader...
2025-12-02 13:42:20,535 - ZeroShotPerturbation - INFO - Loading training data from data/processed/train.h5ad
2025-12-02 13:42:34,653 - ZeroShotPerturbation - INFO - Loading test data from data/processed/test.h5ad
2025-12-02 13:42:37,506 - ZeroShotPerturbation - INFO - Found 38176 control cells.
2025-12-02 13:42:45,008 - ZeroShotPerturbation - INFO - Processing 30 target genes...
2025-12-02 13:42:45,009 - ZeroShotPerturbation - INFO - Predicting for target: AKT2
2025-12-02 13:42:45,012 - ZeroShotPerturbation - INFO - Processing 938 cells in batches of 16
2025-12-02 13:43:08,432 - ZeroShotPerturbation - INFO - Target AKT2 - DES: 0.0136, MAE_top2k: 5.4327, n_DE: 369
2025-12-02 13:43:08,432 - ZeroShotPerturbation - INFO - Predicting for target: MAP3K7
2025-12-02 13:43:08,435 - ZeroShotPerturbation - INFO - Processing 2019 cells in batches of 16
2025-12-02 13:44:00,000 - ZeroShotPerturbation - INFO - Target MAP3K7 - DES: 0.0116, MAE_top2k: 5.5345, n_DE: 86
2025-12-02 13:44:00,000 - ZeroShotPerturbation - INFO - Predicting for target: ZNF426
2025-12-02 13:44:00,003 - ZeroShotPerturbation - INFO - Processing 1132 cells in batches of 16
2025-12-02 13:44:26,907 - ZeroShotPerturbation - INFO - Target ZNF426 - DES: 0.0000, MAE_top2k: 5.3032, n_DE: 14
2025-12-02 13:44:26,908 - ZeroShotPerturbation - INFO - Predicting for target: DNMT1
2025-12-02 13:44:26,910 - ZeroShotPerturbation - INFO - Processing 893 cells in batches of 16
2025-12-02 13:44:47,987 - ZeroShotPerturbation - INFO - Target DNMT1 - DES: 0.5009, MAE_top2k: 5.4362, n_DE: 8133
2025-12-02 13:44:47,987 - ZeroShotPerturbation - INFO - Predicting for target: SRC
2025-12-02 13:44:47,990 - ZeroShotPerturbation - INFO - Processing 2403 cells in batches of 16
2025-12-02 13:45:49,742 - ZeroShotPerturbation - INFO - Target SRC - DES: 0.0078, MAE_top2k: 5.2234, n_DE: 255
2025-12-02 13:45:49,742 - ZeroShotPerturbation - INFO - Predicting for target: MED13
2025-12-02 13:45:49,746 - ZeroShotPerturbation - INFO - Processing 2787 cells in batches of 16
2025-12-02 13:47:01,509 - ZeroShotPerturbation - INFO - Target MED13 - DES: 0.2665, MAE_top2k: 4.9433, n_DE: 4266
2025-12-02 13:47:01,510 - ZeroShotPerturbation - INFO - Predicting for target: KDR
2025-12-02 13:47:01,513 - ZeroShotPerturbation - INFO - Processing 2056 cells in batches of 16
2025-12-02 13:47:54,536 - ZeroShotPerturbation - INFO - Target KDR - DES: 0.0000, MAE_top2k: 5.6729, n_DE: 20
2025-12-02 13:47:54,537 - ZeroShotPerturbation - INFO - Predicting for target: EIF4B
2025-12-02 13:47:54,540 - ZeroShotPerturbation - INFO - Processing 1585 cells in batches of 16
2025-12-02 13:48:33,494 - ZeroShotPerturbation - INFO - Target EIF4B - DES: 0.2797, MAE_top2k: 5.4277, n_DE: 4383
2025-12-02 13:48:33,495 - ZeroShotPerturbation - INFO - Predicting for target: SIX4
2025-12-02 13:48:33,497 - ZeroShotPerturbation - INFO - Processing 642 cells in batches of 16
2025-12-02 13:48:48,771 - ZeroShotPerturbation - INFO - Target SIX4 - DES: 0.0000, MAE_top2k: 5.2369, n_DE: 94
2025-12-02 13:48:48,772 - ZeroShotPerturbation - INFO - Predicting for target: TFAM
2025-12-02 13:48:48,774 - ZeroShotPerturbation - INFO - Processing 1105 cells in batches of 16
2025-12-02 13:49:15,037 - ZeroShotPerturbation - INFO - Target TFAM - DES: 0.1960, MAE_top2k: 5.0669, n_DE: 2929
2025-12-02 13:49:15,038 - ZeroShotPerturbation - INFO - Predicting for target: MAST2
2025-12-02 13:49:15,041 - ZeroShotPerturbation - INFO - Processing 1029 cells in batches of 16
2025-12-02 13:49:39,667 - ZeroShotPerturbation - INFO - Target MAST2 - DES: 0.0000, MAE_top2k: 5.5798, n_DE: 19
2025-12-02 13:49:39,667 - ZeroShotPerturbation - INFO - Predicting for target: SMAGP
2025-12-02 13:49:39,670 - ZeroShotPerturbation - INFO - Processing 788 cells in batches of 16
2025-12-02 13:49:58,692 - ZeroShotPerturbation - INFO - Target SMAGP - DES: 0.0650, MAE_top2k: 5.6116, n_DE: 769
2025-12-02 13:49:58,692 - ZeroShotPerturbation - INFO - Predicting for target: XRCC4
2025-12-02 13:49:58,695 - ZeroShotPerturbation - INFO - Processing 591 cells in batches of 16
2025-12-02 13:50:12,873 - ZeroShotPerturbation - INFO - Target XRCC4 - DES: 0.1658, MAE_top2k: 4.6014, n_DE: 3419
2025-12-02 13:50:12,874 - ZeroShotPerturbation - INFO - Predicting for target: HMGN1
2025-12-02 13:50:12,877 - ZeroShotPerturbation - INFO - Processing 2004 cells in batches of 16
2025-12-02 13:51:04,803 - ZeroShotPerturbation - INFO - Target HMGN1 - DES: 0.0000, MAE_top2k: 5.5446, n_DE: 12
2025-12-02 13:51:04,803 - ZeroShotPerturbation - INFO - Predicting for target: GSK3B
2025-12-02 13:51:04,806 - ZeroShotPerturbation - INFO - Processing 1059 cells in batches of 16
2025-12-02 13:51:30,415 - ZeroShotPerturbation - INFO - Target GSK3B - DES: 0.1587, MAE_top2k: 5.4152, n_DE: 2306
2025-12-02 13:51:30,415 - ZeroShotPerturbation - INFO - Predicting for target: TMBIM6
2025-12-02 13:51:30,418 - ZeroShotPerturbation - INFO - Processing 505 cells in batches of 16
2025-12-02 13:51:42,415 - ZeroShotPerturbation - INFO - Target TMBIM6 - DES: 0.0000, MAE_top2k: 6.4237, n_DE: 66
2025-12-02 13:51:42,415 - ZeroShotPerturbation - INFO - Predicting for target: PMEL
2025-12-02 13:51:42,417 - ZeroShotPerturbation - INFO - Processing 356 cells in batches of 16
2025-12-02 13:51:50,837 - ZeroShotPerturbation - INFO - Target PMEL - DES: 0.0000, MAE_top2k: 5.8025, n_DE: 43
2025-12-02 13:51:50,838 - ZeroShotPerturbation - INFO - Predicting for target: DAXX
2025-12-02 13:51:50,841 - ZeroShotPerturbation - INFO - Processing 1332 cells in batches of 16
2025-12-02 13:52:22,865 - ZeroShotPerturbation - INFO - Target DAXX - DES: 0.0825, MAE_top2k: 5.2957, n_DE: 727
2025-12-02 13:52:22,866 - ZeroShotPerturbation - INFO - Predicting for target: METTL14
2025-12-02 13:52:22,868 - ZeroShotPerturbation - INFO - Processing 468 cells in batches of 16
2025-12-02 13:52:34,089 - ZeroShotPerturbation - INFO - Target METTL14 - DES: 0.5859, MAE_top2k: 3.0586, n_DE: 9306
2025-12-02 13:52:34,089 - ZeroShotPerturbation - INFO - Predicting for target: MAU2
2025-12-02 13:52:34,091 - ZeroShotPerturbation - INFO - Processing 1021 cells in batches of 16
2025-12-02 13:52:58,507 - ZeroShotPerturbation - INFO - Target MAU2 - DES: 0.4109, MAE_top2k: 4.4869, n_DE: 6800
2025-12-02 13:52:58,508 - ZeroShotPerturbation - INFO - Predicting for target: NDUFB4
2025-12-02 13:52:58,511 - ZeroShotPerturbation - INFO - Processing 1413 cells in batches of 16
2025-12-02 13:53:32,870 - ZeroShotPerturbation - INFO - Target NDUFB4 - DES: 0.0873, MAE_top2k: 6.1368, n_DE: 1077
2025-12-02 13:53:32,871 - ZeroShotPerturbation - INFO - Predicting for target: KDM1A
2025-12-02 13:53:32,873 - ZeroShotPerturbation - INFO - Processing 352 cells in batches of 16
2025-12-02 13:53:41,229 - ZeroShotPerturbation - INFO - Target KDM1A - DES: 0.6399, MAE_top2k: 2.2444, n_DE: 10107
2025-12-02 13:53:41,230 - ZeroShotPerturbation - INFO - Predicting for target: TXNDC9
2025-12-02 13:53:41,232 - ZeroShotPerturbation - INFO - Processing 514 cells in batches of 16
2025-12-02 13:53:53,688 - ZeroShotPerturbation - INFO - Target TXNDC9 - DES: 0.0222, MAE_top2k: 5.0577, n_DE: 180
2025-12-02 13:53:53,689 - ZeroShotPerturbation - INFO - Predicting for target: CALM3
2025-12-02 13:53:53,691 - ZeroShotPerturbation - INFO - Processing 681 cells in batches of 16
2025-12-02 13:54:10,077 - ZeroShotPerturbation - INFO - Target CALM3 - DES: 0.0670, MAE_top2k: 6.9533, n_DE: 836
2025-12-02 13:54:10,077 - ZeroShotPerturbation - INFO - Predicting for target: C1QBP
2025-12-02 13:54:10,080 - ZeroShotPerturbation - INFO - Processing 711 cells in batches of 16
2025-12-02 13:54:27,141 - ZeroShotPerturbation - INFO - Target C1QBP - DES: 0.1762, MAE_top2k: 4.5230, n_DE: 3275
2025-12-02 13:54:27,141 - ZeroShotPerturbation - INFO - Predicting for target: MBTPS1
2025-12-02 13:54:27,143 - ZeroShotPerturbation - INFO - Processing 626 cells in batches of 16
2025-12-02 13:54:42,243 - ZeroShotPerturbation - INFO - Target MBTPS1 - DES: 0.2425, MAE_top2k: 4.4669, n_DE: 4156
2025-12-02 13:54:42,244 - ZeroShotPerturbation - INFO - Predicting for target: ZNF562
2025-12-02 13:54:42,246 - ZeroShotPerturbation - INFO - Processing 418 cells in batches of 16
2025-12-02 13:54:52,273 - ZeroShotPerturbation - INFO - Target ZNF562 - DES: 0.0000, MAE_top2k: 5.7550, n_DE: 25
2025-12-02 13:54:52,273 - ZeroShotPerturbation - INFO - Predicting for target: PHF10
2025-12-02 13:54:52,275 - ZeroShotPerturbation - INFO - Processing 450 cells in batches of 16
2025-12-02 13:55:03,060 - ZeroShotPerturbation - INFO - Target PHF10 - DES: 0.0630, MAE_top2k: 5.0726, n_DE: 683
2025-12-02 13:55:03,060 - ZeroShotPerturbation - INFO - Predicting for target: FDPS
2025-12-02 13:55:03,062 - ZeroShotPerturbation - INFO - Processing 154 cells in batches of 16
2025-12-02 13:55:06,776 - ZeroShotPerturbation - INFO - Target FDPS - DES: 0.1226, MAE_top2k: 5.5208, n_DE: 2308
2025-12-02 13:55:06,776 - ZeroShotPerturbation - INFO - Predicting for target: OXA1L
2025-12-02 13:55:06,778 - ZeroShotPerturbation - INFO - Processing 63 cells in batches of 16
2025-12-02 13:55:08,215 - ZeroShotPerturbation - INFO - Target OXA1L - DES: 0.0140, MAE_top2k: 4.4184, n_DE: 357
2025-12-02 13:55:08,271 - ZeroShotPerturbation - INFO - Results saved to results/scgpt_finetuned/perturbation_metrics.csv
2025-12-02 13:55:08,272 - ZeroShotPerturbation - INFO - ==================================================
2025-12-02 13:55:08,272 - ZeroShotPerturbation - INFO - Overall Metrics:
2025-12-02 13:55:08,272 - ZeroShotPerturbation - INFO -   nPDS (normalized):     0.5167
2025-12-02 13:55:08,272 - ZeroShotPerturbation - INFO -   Mean DES:              0.1393
2025-12-02 13:55:08,272 - ZeroShotPerturbation - INFO -   Mean MAE_top2k:        5.1749
2025-12-02 13:55:08,272 - ZeroShotPerturbation - INFO - ==================================================
