{
  "config": {
    "data": {
      "h5ad_path": "data/norman/perturb_processed.h5ad"
    },
    "split": {
      "min_cells_per_condition": 50,
      "query_fraction": 0.2,
      "min_query_cells": 10,
      "seed": 42,
      "output_path": "data/norman/splits/cell_split_seed42.json"
    },
    "track": "in_dist",
    "condition_split": {
      "train_ratio": 0.7,
      "val_ratio": 0.1,
      "test_ratio": 0.2,
      "seed": 42,
      "output_path": "data/norman/splits/condition_split_in_dist_seed42.json",
      "n_holdout_genes": 5
    },
    "model": {
      "encoder": "scgpt",
      "checkpoint": null,
      "finetune_checkpoint": "model/scgpt_finetune/best_head_only.pt",
      "finetune_apply_head": true,
      "freeze_encoder": true,
      "use_lora": false,
      "lora_rank": 8
    },
    "library": {
      "type": "bootstrap",
      "n_prototypes": 30,
      "m_cells_per_prototype": 50,
      "seed": 42
    },
    "retrieval": {
      "metric": "cosine",
      "top_k": [
        1,
        5,
        8,
        10
      ]
    },
    "query": {
      "mode": "cell",
      "query_split": "test",
      "candidate_source": "all",
      "pseudo_bulk": {
        "cells_per_bulk": 50,
        "n_bulks": 1,
        "seed": 42
      },
      "pseudo_bulk_curve": {
        "enable": false,
        "cells_per_bulk_values": [
          10,
          25,
          50,
          100,
          200
        ],
        "n_bulks": 5,
        "seed": 42
      }
    },
    "evaluate": {
      "mask_perturbed": true,
      "mask_ablation": true
    },
    "confidence": {
      "enable": true,
      "method": "margin",
      "coverage_points": 20,
      "top_k_agreement": 1
    },
    "report": {
      "enable": false,
      "result_dirs": [],
      "output_dir": "results/reports",
      "report_name": "comparison_report"
    },
    "logging": {
      "output_dir": "results/",
      "experiment_name": "scgpt"
    }
  },
  "summary": {
    "h5ad_path": "data/norman/perturb_processed.h5ad",
    "loaded": true,
    "has_split": true,
    "n_cells": 91205,
    "n_genes": 5045,
    "n_control_cells": 7353,
    "n_perturbed_cells": 83852,
    "n_conditions": 282,
    "n_ref_cells": 67152,
    "n_query_cells": 16651,
    "n_valid_conditions": 282,
    "n_dropped_conditions": 1,
    "split_seed": 42
  },
  "metrics": {
    "exact_hit@1": 0.07561107440994534,
    "exact_hit@5": 0.23235841691189718,
    "exact_hit@8": 0.303645426701099,
    "exact_hit@10": 0.3408804276019458,
    "mrr": 0.14336307081037128,
    "relevant_hit@1": 0.25109603026845234,
    "relevant_hit@5": 0.43847216383400395,
    "relevant_hit@8": 0.5014113266470482,
    "relevant_hit@10": 0.5331211338658339,
    "ndcg@1": 0.07561107440994534,
    "ndcg@5": 0.1544659041343186,
    "ndcg@8": 0.1784641698962616,
    "ndcg@10": 0.18946966232234555,
    "macro_hit@1": 0.06846295202111391,
    "macro_hit@5": 0.21702694041543666,
    "n_queries": 16651,
    "n_in_pool": 16651,
    "n_conditions": 282,
    "confidence_auc": 0.11162346933008327,
    "coverage_accuracy_curve": {
      "coverage": [
        0.05,
        0.1,
        0.15,
        0.2,
        0.25,
        0.3,
        0.35,
        0.39999999999999997,
        0.44999999999999996,
        0.49999999999999994,
        0.5499999999999999,
        0.6,
        0.65,
        0.7,
        0.75,
        0.7999999999999999,
        0.85,
        0.9,
        0.95,
        1.0
      ],
      "accuracy": [
        0.2608173076923077,
        0.2126126126126126,
        0.17981577893472167,
        0.15825825825825826,
        0.1446419990389236,
        0.13113113113113112,
        0.12287626565985928,
        0.11576576576576576,
        0.1095835557928457,
        0.10354354354354355,
        0.09936667394627648,
        0.0947947947947948,
        0.09174905294280698,
        0.08923208923208924,
        0.08664317745035234,
        0.08453453453453454,
        0.08252667279022115,
        0.07954621287954622,
        0.07763307624225566,
        0.07561107440994534
      ]
    }
  },
  "metrics_mask_off": {
    "exact_hit@1": 0.0794546874061618,
    "exact_hit@5": 0.23932496546753948,
    "exact_hit@8": 0.3100114107260825,
    "exact_hit@10": 0.3462254519248093,
    "mrr": 0.14909340970988919,
    "relevant_hit@1": 0.2556603207014594,
    "relevant_hit@5": 0.44423758332832863,
    "relevant_hit@8": 0.5035133025043541,
    "relevant_hit@10": 0.5369046904089845,
    "ndcg@1": 0.0794546874061618,
    "ndcg@5": 0.16068967323676753,
    "ndcg@8": 0.1845074968279167,
    "ndcg@10": 0.1952034940024046,
    "macro_hit@1": 0.07138464873020124,
    "macro_hit@5": 0.22489539186017843,
    "n_queries": 16651,
    "n_in_pool": 16651,
    "n_conditions": 282,
    "confidence_auc": 0.11025125987518575,
    "coverage_accuracy_curve": {
      "coverage": [
        0.05,
        0.1,
        0.15,
        0.2,
        0.25,
        0.3,
        0.35,
        0.39999999999999997,
        0.44999999999999996,
        0.49999999999999994,
        0.5499999999999999,
        0.6,
        0.65,
        0.7,
        0.75,
        0.7999999999999999,
        0.85,
        0.9,
        0.95,
        1.0
      ],
      "accuracy": [
        0.23317307692307693,
        0.1927927927927928,
        0.16900280336403684,
        0.15165165165165165,
        0.14079769341662662,
        0.13133133133133132,
        0.12218980607516733,
        0.11546546546546546,
        0.1101174586225307,
        0.10618618618618618,
        0.10209652762611925,
        0.09779779779779779,
        0.09368936524069112,
        0.09103389103389103,
        0.08984625240230622,
        0.08693693693693694,
        0.08464636472832615,
        0.08208208208208208,
        0.08104690858515615,
        0.0794546874061618
      ]
    }
  }
}