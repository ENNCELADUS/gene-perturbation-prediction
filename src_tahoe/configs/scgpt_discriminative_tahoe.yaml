# scGPT Discriminative Configuration (Tahoe Drug Split)

# Data
data:
  dataset: tahoe
  h5ad_path: data/processed/tahoe/tahoe_log1p.h5ad
  control_match_keys: []
  control_n_samples: 1
  control_layer: ctrl

# Tahoe drug-based condition split
condition_split:
  output_path: data/processed/tahoe/splits/tahoe_drug_split_seed42.json
  seed: 42
  test_ratio: 0.2
  single_val_ratio: 0.1
  multi_val_ratio: 0.15
  single_target_test_per_gene: 0
  multi_test_max_targets: 3
  multi_test_fallback_max_targets: 4
  min_cells_per_condition: 5

# Model
model:
  encoder: scgpt
  pretrained_dir: model/scGPT
  freeze_encoder: true
  preprocess_binning: 51

# Training
training:
  epochs: 200
  batch_size: 32
  head_learning_rate: 5.0e-5
  backbone_learning_rate: 1.0e-5
  weight_decay: 0.01
  warmup_ratio: 0.2
  unfreeze_last_n_layers: 3
  balanced_sampling: true
  gene_weighted_sampling: false
  sample_weight_alpha: 0.1
  sample_weight_cap: 5.0
  sample_weight_eps: 1.0
  weighted_samples_per_replica: null
  sampling_seed: 0
  control_chunk_size: 64
  control_no_grad: true
  balanced_sampling_n_conditions: 8
  balanced_sampling_n_cells: 4
  early_stopping_patience: 6
  early_stopping_metric: val_loss
  ranking_loss_weight: 0.7
  bce_loss_weight: 0.1
  ranking_num_negatives: 64
  ranking_margin: 0.0
  ranking_hard_negative_ratio: 0.05
  ranking_hard_candidate_factor: 2.0
  ranking_pos_weight_alpha: 0.3
  ranking_pos_weight_cap: 5.0
  ranking_pos_weight_eps: 1.0
  bce_pos_weight_enabled: true
  bce_pos_weight_cap: 50.0
  bce_pos_weight_min: 1.0

# Head
head:
  score_mode: dot
  hidden_dim: 512
  dropout: 0.2

# Evaluation
evaluation:
  checkpoint_path: results/scgpt_discriminative_tahoe/best_model.pt
  top_k_values: [1, 5, 10, 20, 40]
  mask: 0
  output_path: results/scgpt_discriminative_tahoe/eval_results.json

# Logging
logging:
  output_dir: results/scgpt_discriminative_tahoe
